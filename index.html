<!DOCTYPE html>
<html lang="bs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Prijava ‚Äì Centrotours B2B Workshop 2025</title>
  <link rel="icon" href="favicon.ico" />
  <meta name="theme-color" content="#0ea5e9" />
  <style>
    :root{
      --primary:#0ea5e9;       /* light-sky */
      --primary-700:#0284c7;
      --accent:#22c55e;        /* lime/green */
      --bg:#f3fbff;            /* very light */
      --text:#0b1a2b; 
      --muted:#44627d;
      --radius:18px; 
      --shadow:0 12px 40px rgba(2, 132, 199, .18);
      --border:1px solid rgba(2, 132, 199, .18);
    }
    html,body{height:100%}
    body{
      margin:0; font-family:Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, Helvetica, sans-serif;
      color:var(--text);
      background:
        radial-gradient(1400px 800px at 10% -20%, #e0f7ff 0%, transparent 80%),
        radial-gradient(1400px 800px at 110% 10%, #d1f7ff 0%, transparent 80%),
        linear-gradient(180deg, #c7f1ff 0%, #f3fbff 100%);
      background-attachment: fixed;
      overflow-x: hidden;
    }
    .hero-bg{position:fixed; inset:0; background-position:center; background-size:cover; opacity:.22; z-index:-1; transition:background-image .6s ease}
    .hero-bg::after{
      content:""; position:absolute; inset:0;
      background:
        radial-gradient(500px 500px at 85% 10%, rgba(255,235,140,.55), transparent 60%),
        linear-gradient(180deg, rgba(255,255,255,.45), rgba(255,255,255,0));
      pointer-events:none;
    }
    header.sticky{
      position:sticky; top:0; z-index:50; backdrop-filter:saturate(130%) blur(10px);
      background:linear-gradient(180deg, rgba(255,255,255,.9), rgba(255,255,255,.75));
      border-bottom:var(--border);
    }
    .wrap{max-width:1120px; margin:0 auto; padding:14px 20px; display:flex; align-items:center; gap:14px}
    .logo{height:40px; filter:drop-shadow(0 4px 10px rgba(2,132,199,.25))}
    .brand{font-weight:800; letter-spacing:.2px}
    .badges{margin-left:auto; display:flex; gap:8px; flex-wrap:wrap}
    .badge{display:inline-flex; align-items:center; gap:8px; padding:8px 12px; border-radius:999px; border:1px solid rgba(2,132,199,.2);
      background:#ffffffbf; color:#0b1a2b; font-size:13px}
    .badge strong{color:#0b1a2b}
    main{max-width:1120px; margin:28px auto; padding:0 16px 80px}
    .card{border:var(--border); border-radius:var(--radius); box-shadow:var(--shadow); overflow:hidden;
      background:linear-gradient(180deg, #ffffffcc, #ffffff)}
    .sub{color:var(--muted); font-size:14px}
    .title{font-size:clamp(22px,3vw,32px); font-weight:800; margin:0}
    .head{display:grid; grid-template-columns:1fr auto; gap:16px; padding:22px; border-bottom:var(--border);
      background:linear-gradient(180deg, #ffffff, #f7fdff)}
    .progress{--h:10px; height:var(--h); margin:16px 22px; background:#e8f6ff; border:var(--border); border-radius:999px; overflow:hidden}
    .progress>span{display:block; height:100%; width:0; background:linear-gradient(90deg, var(--accent), var(--primary)); transition:width .4s ease}
    form{padding:18px 22px 10px}
    .step{display:none; animation:fade .45s ease}
    .step.active{display:block}
    @keyframes fade{from{opacity:0; transform:translateY(8px)} to{opacity:1; transform:none}}
    .grid{display:grid; gap:14px}
    .g-2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .g-3{grid-template-columns:repeat(3,minmax(0,1fr))}
    @media (max-width:860px){.g-2,.g-3{grid-template-columns:1fr}}
    .field input,.field select,.field textarea{
      width:100%; background:#ffffff; color:var(--text); border:1px solid rgba(2,132,199,.26);
      padding:14px 12px; border-radius:12px; outline:none; transition:border .2s, box-shadow .2s; font-size:16px
    }
    .field input::placeholder,.field textarea::placeholder{color:#7aa8c4}
    .field textarea{min-height:110px; resize:vertical}
    .field input:focus,.field select:focus,.field textarea:focus{
      border-color:#0284c7; box-shadow:0 0 0 4px rgba(14,165,233,.18)
    }
    .group{border:1px dashed rgba(2,132,199,.35); padding:14px; border-radius:12px; background:#ffffff}
    .group legend{font-weight:800; color:#0b1a2b}
    .checks{display:grid; gap:8px; grid-template-columns:repeat(2,minmax(0,1fr))}
    @media (max-width:860px){.checks{grid-template-columns:1fr}}
    .controls{display:flex; justify-content:space-between; gap:12px; padding:16px 22px 22px}
    .btn{appearance:none; border:none; border-radius:12px; padding:12px 18px; cursor:pointer; font-weight:800; letter-spacing:.2px; font-size:16px}
    .btn.primary{color:#03131f; background:linear-gradient(90deg, #a7f3d0, #7dd3fc)}
    .btn.primary:hover{filter:saturate(110%)}
    .btn.ghost{background:#ffffff; color:#0b1a2b; border:1px solid rgba(2,132,199,.35)}
    .btn[disabled]{opacity:.65; cursor:not-allowed}
    .meta{color:var(--muted)}
    .success{display:none; text-align:center; padding:38px}
    .success.show{display:block; animation:pop .45s ease}
    @keyframes pop{from{opacity:0; transform:scale(.98)} to{opacity:1; transform:scale(1)}}
    .toast{position:fixed; right:16px; bottom:16px; background:#fff; color:#0b1a2b; border:1px solid rgba(2,132,199,.3); padding:12px 14px; border-radius:12px; box-shadow:var(--shadow);
      opacity:0; transform:translateY(8px); pointer-events:none; transition:all .3s}
    .toast.show{opacity:1; transform:none}
    .watermark{opacity:.6; font-size:12px; text-align:center; margin-top:16px}
    /* Modal ‚Äì svjetliji, ljetni stil */
    .modal{position:fixed; inset:0; background:linear-gradient(180deg, rgba(255,255,255,.6), rgba(255,255,255,.3)); display:flex; align-items:center; justify-content:center; z-index:9999}
    .modal-card{
      max-width:720px; margin:16px; background:#ffffff; border:2px solid #93c5fd; border-radius:18px; 
      padding:20px 22px; box-shadow:0 20px 60px rgba(2,132,199,.25);
      background-image: radial-gradient(600px 300px at 90% -10%, #fff1b1 0%, transparent 60%);
    }
    .modal h3{margin:0 0 10px 0; font-size:26px; color:#0b1a2b}
    .modal .count{font-weight:900; color:#0b1a2b}
  </style>
</head>
<body>
  <!-- Dinamiƒçna pozadina po koracima -->
  <div class="hero-bg" id="hero"></div>

  <!-- Modal: Dobrodo≈°li s tajmerom 7s (auto-close; ne mo≈æe se ranije zatvoriti) -->
  <div class="modal" id="welcomeModal" aria-modal="true" role="dialog">
    <div class="modal-card">
      <h3>Dobrodo≈°li na <strong>Centrotours B2B Workshop 2025</strong></h3>
      <p class="meta">Swissotel Sarajevo ‚Ä¢ <strong>14. novembar 2025</strong> ‚Ä¢ Prijave do <strong>6. novembra 2025</strong></p>
      <p class="meta">Najveƒái turistiƒçki B2B event u BiH ‚Äì 100+ agencija ‚Ä¢ 30+ turskih hotela. Turizam nas spaja üíô</p>
      <p class="meta">Ovaj prozor ƒáe se automatski zatvoriti za <span class="count" id="countdown">7</span>s.</p>
      <button class="btn primary" id="closeWelcome" disabled>Zatvori</button>
    </div>
  </div>

  <header class="sticky">
    <div class="wrap">
      <img src="logo.png" alt="Centrotours" class="logo" />
      <div class="brand">Centrotours ‚Ä¢ B2B Workshop</div>
      <div class="badges">
        <span class="badge">üìç <strong>Swissotel Sarajevo</strong></span>
        <span class="badge">üóìÔ∏è <strong>14. nov 2025</strong> ‚Ä¢ ‚è∞ <strong>10:00‚Äì18:00</strong></span>
        <span class="badge">üïí Prijave do: <strong>6. nov 2025</strong></span>
      </div>
    </div>
  </header>

  <main>
    <section class="card">
      <div class="head">
        <div>
          <h1 class="title">Prijava za Centrotours Summer T√ºrkiye Workshop 2026</h1>
          <div class="sub">Ispunite podatke ‚Äì kontaktiraƒáemo vas radi potvrde termina sastanaka sa hotelima.</div>
        </div>
        <div class="badge">Turizam nas spaja üíô</div>
      </div>

      <div class="progress"><span id="bar"></span></div>

      <!--
        VA≈ΩNO:
        - Ovaj formular koristi imena polja koja Apps Script oƒçekuje.
        - scriptURL postavite na VA≈† Web App URL (sa /exec).
      -->
      <form id="form">
        <!-- Hidden ID + honey pot -->
        <input type="hidden" name="entry_id" id="entry_id" />
        <input type="text" name="company" id="hp" style="display:none" tabindex="-1" autocomplete="off" />

        <!-- KORAK 1: Uvod -->
        <div class="step active" data-step="1">
          <p class="meta">Dobrodo≈°li! Pritisnite ‚ÄúDalje‚Äù i pratite korake. Sva obavezna polja su oznaƒçena zvjezdicom (*).</p>
        </div>

        <!-- KORAK 2: Osnovni podaci o agenciji -->
        <div class="step" data-step="2">
          <div class="grid g-2">
            <div class="field"><input required name="nazivAgencije" placeholder="Naziv agencije *"/></div>
            <div class="field"><input required name="grad" placeholder="Grad / sjedi≈°te *"/></div>
            <div class="field"><input name="web" placeholder="Web stranica (https://)"/></div>
            <div class="field"><input required type="number" min="1" name="brojZaposlenih" placeholder="Broj zaposlenih *"/></div>
            <div class="field"><input required type="number" min="1900" max="2100" name="godinaOsnivanja" placeholder="Godina osnivanja *"/></div>
          </div>
        </div>

        <!-- KORAK 3: Kontakt osoba -->
        <div class="step" data-step="3">
          <div class="grid g-2">
            <div class="field"><input required name="imePrezime" placeholder="Ime i prezime *"/></div>
            <div class="field"><input required name="pozicija" placeholder="Pozicija u agenciji *"/></div>
            <div class="field"><input required type="email" name="email" placeholder="E-mail *"/></div>
            <div class="field">
              <!-- Telefon: samo cifre, 9‚Äì15 -> xxxxxxxxx -->
              <input required inputmode="numeric" pattern="^[0-9]{9,15}$" name="telefon" placeholder="Broj telefona / mobitel (samo cifre, 9‚Äì15) *" />
            </div>
          </div>
          <!-- KOMENTAR: Ako ≈æeli≈° internacionalni format, dodaj zasebno polje za pozivni broj. -->
        </div>

        <!-- KORAK 4: Poslovni profil agencije -->
        <div class="step" data-step="4">
          <fieldset class="group">
            <legend>Glavna tr≈æi≈°ta na kojima poslujete *</legend>
            <div class="checks">
              <label><input type="checkbox" name="trzista" value="Bosna i Hercegovina"> Bosna i Hercegovina</label>
              <label><input type="checkbox" name="trzista" value="Hrvatska / Srbija / Crna Gora"> Hrvatska / Srbija / Crna Gora</label>
              <label><input type="checkbox" name="trzista" value="Zapadna Evropa"> Zapadna Evropa</label>
              <label><input type="checkbox" name="trzista" value="Bliski Istok"> Bliski Istok</label>
              <label><input type="checkbox" name="trzista" value="Ostalo"> Ostalo</label>
            </div>
          </fieldset>

          <fieldset class="group" style="margin-top:12px">
            <legend>Prosjeƒçan broj prodatih aran≈æmana godi≈°nje *</legend>
            <div class="checks">
              <label><input type="radio" required name="brojAranzmana" value="do 200"> do 200</label>
              <label><input type="radio" name="brojAranzmana" value="200‚Äì500"> 200‚Äì500</label>
              <label><input type="radio" name="brojAranzmana" value="500‚Äì1000"> 500‚Äì1000</label>
              <label><input type="radio" name="brojAranzmana" value="preko 1000"> preko 1000</label>
            </div>
          </fieldset>

          <fieldset class="group" style="margin-top:12px">
            <legend>Najƒçe≈°ƒáe destinacije koje nudite *</legend>
            <div class="checks">
              <label><input type="checkbox" name="destinacije" value="Turska"> Turska</label>
              <label><input type="checkbox" name="destinacije" value="Egipat"> Egipat</label>
              <label><input type="checkbox" name="destinacije" value="Tunis"> Tunis</label>
              <label><input type="checkbox" name="destinacije" value="Grƒçka"> Grƒçka</label>
              <label><input type="checkbox" name="destinacije" value="Italija"> Italija</label>
              <label><input type="checkbox" name="destinacije" value="Ostalo"> Ostalo</label>
            </div>
          </fieldset>
        </div>

        <!-- KORAK 5: Interes za sastanke (B2B dio) -->
        <div class="step" data-step="5">
          <fieldset class="group">
            <legend>Interes za sastanke (B2B dio) *</legend>
            <p class="meta" style="margin-top:0">Oznaƒçite tipove hotela sa kojima ≈æelite termin.</p>
            <div class="checks">
              <label><input type="checkbox" name="sastanak" value="Porodiƒçni hoteli"> Porodiƒçni hoteli</label>
              <label><input type="checkbox" name="sastanak" value="Adults Only hoteli"> Adults Only hoteli</label>
              <label><input type="checkbox" name="sastanak" value="Luksuzni resorti"> Luksuzni resorti</label>
              <label><input type="checkbox" name="sastanak" value="Hoteli sa velikim kapacitetima"> Veliki kapaciteti</label>
              <label><input type="checkbox" name="sastanak" value="Hoteli sa sportskim sadr≈æajima"> Sportski sadr≈æaji</label>
            </div>
          </fieldset>

          <div class="grid g-2" style="margin-top:12px">
            <div class="field"><input required type="number" min="1" name="brojOsoba" placeholder="Broj osoba iz va≈°e agencije *"/></div>
            <div class="group">
              <legend>Da li govorite engleski jezik? *</legend>
              <div class="checks">
                <label><input type="radio" required name="engleski" value="Da"> Da</label>
                <label><input type="radio" name="engleski" value="Ne"> Ne</label>
              </div>
            </div>
            <div class="field" style="grid-column:1/-1"><textarea name="napomene" placeholder="Dodatne napomene ili posebni zahtjevi"></textarea></div>
          </div>
        </div>

        <!-- KORAK 6: Logistika i potvrda uƒçe≈°ƒáa -->
        <div class="step" data-step="6">
          <div class="grid g-2">
            <div class="group">
              <legend>Networking Dinner u Swissotelu? *</legend>
              <div class="checks">
                <label><input type="radio" required name="vecera" value="Da"> Da</label>
                <label><input type="radio" name="vecera" value="Ne"> Ne</label>
              </div>
            </div>
            <div class="group">
              <legend>Potreban smje≈°taj u Sarajevu? *</legend>
              <div class="checks">
                <label><input type="radio" required name="smjestaj" value="Da"> Da</label>
                <label><input type="radio" name="smjestaj" value="Ne"> Ne</label>
              </div>
            </div>
            <div class="field" style="grid-column:1/-1">
              <textarea name="parking" placeholder="Napomena za parking / dolazak"></textarea>
            </div>
          </div>
        </div>

        <!-- KORAK 7: Saglasnost i potpis -->
        <div class="step" data-step="7">
          <div class="group">
            <p class="meta">‚úÖ Saglasan/na sam da Centrotours koristi navedene podatke u svrhu organizacije B2B radionice i daljnje poslovne komunikacije.</p>
            <label style="display:flex; gap:10px; align-items:center">
              <input type="checkbox" required name="saglasnost" value="DA"> Potvrƒëujem saglasnost
            </label>
          </div>
          <div class="grid g-2" style="margin-top:12px">
            <div class="field"><input required name="potpis" placeholder="Potpis (ime i prezime) *"/></div>
          </div>
          <!-- KOMENTAR: Po ≈æelji dodati e-potpis (canvas) i slati base64 PNG u polje 'signature_data'. -->
        </div>

        <div class="controls">
          <button type="button" class="btn ghost" id="prev">‚üµ Nazad</button>
          <button type="button" class="btn primary" id="next">Dalje ‚ü∂</button>
        </div>
      </form>

      <div class="success" id="success">
        <h2 style="margin:0 0 8px 0">üéâ Hvala vam na prijavi!</h2>
        <p class="meta">Va≈°a agencija je uspje≈°no registrovana. Potvrda je preuzeta kao PDF. Uskoro ƒáemo vas kontaktirati.</p>
        <p class="watermark">Vidimo se u Sarajevu! ‚Äî Centrotours Team üíô</p>
      </div>
    </section>

    <p class="watermark">¬© Centrotours ‚Ä¢ B2B Workshop 2025</p>
  </main>

  <div class="toast" id="toast">Gre≈°ka pri slanju. Poku≈°ajte ponovo.</div>

  <!-- Dekorativni val na dnu (summer vibez) -->
  <svg style="position:fixed; left:0; right:0; bottom:-1px; z-index:-1; opacity:.35" width="100%" height="120" viewBox="0 0 1440 120" preserveAspectRatio="none" aria-hidden="true">
    <path d="M0,80 C240,140 480,0 720,60 C960,120 1200,20 1440,70 L1440,120 L0,120 Z" fill="#c7f1ff"/>
  </svg>

  <!-- Minimal QRCode generator (inline) -->
  <script>
  /*! ultra-min QR (naive) ‚Äî dovoljno za link/ID */
  (function(w){function D(d){this.d=d}D.prototype={getLength:function(){return this.d.length},write:function(b){for(var i=0;i<this.d.length;i++)b.put(this.d.charCodeAt(i),8)}};
  function Q(t,l){this.typeNumber=t;this.errorCorrectLevel=l;this.modules=null;this.moduleCount=0;this.dataCache=null;this.dataList=[]}
  var EC={M:0};Q.prototype={addData:function(d){this.dataList.push(new D(d));this.dataCache=null},isDark:function(r,c){return this.modules[r][c]},
  getModuleCount:function(){return this.moduleCount},make:function(){this.moduleCount=21+4*(this.typeNumber-1);this.modules=Array(this.moduleCount).fill(0).map(()=>Array(this.moduleCount).fill(null));
  // finder
  function box(R,C){for(var r=0;r<7;r++)for(var c=0;c<7;c++)Q.this.modules[R+r][C+c]=(r==0||c==0||r==6||c==6||((r>=2&&r<=4)&&(c>=2&&c<=4)))}Q.this=this;
  box(0,0);box(0,this.moduleCount-7);box(this.moduleCount-7,0);
  for(var i=8;i<this.moduleCount-8;i++)this.modules[i][6]=this.modules[6][i]=i%2==0;
  // data fill (naive)
  var data=[];this.dataList.forEach(d=>{for(var i=0;i<d.getLength();i++)for(var b=7;b>=0;b--)data.push((d.d.charCodeAt(i)>>b)&1)});
  for(var col=this.moduleCount-1,dir=-1;col>0;col-=2){if(col==6)col--;for(var r=0;r<this.moduleCount;r++){var rr=dir>0?this.moduleCount-1-r:r;
    for(var cc=0;cc<2;cc++)if(this.modules[rr][col-cc]===null)this.modules[rr][col-cc]=data.length?!!data.shift():false}dir*=-1}},
  toDataURL:function(scale){scale=scale||6;var n=this.getModuleCount(),cv=document.createElement('canvas');cv.width=cv.height=n*scale;var x=cv.getContext('2d');
  x.fillStyle='#fff';x.fillRect(0,0,cv.width,cv.height);x.fillStyle='#000';for(var r=0;r<n;r++)for(var c=0;c<n;c++)this.isDark(r,c)&&x.fillRect(c*scale,r*scale,scale,scale);return cv.toDataURL('image/png')}}
  function gen(v){for(var t=1;t<=10;t++){var q=new Q(t,EC.M);q.addData(v);q.make();if(q.getModuleCount()<=177)return q.toDataURL(6)}return null}
  w._miniQR=gen})(window);
  </script>

  <!-- PDF generator (print-to-PDF kroz novi window) -->
  <script>
  async function generatePDF(data, qrDataURL){
    const id = data.entry_id;
    const base = location.origin + location.pathname.replace(/[^/]+$/,'');
    const html = ''
    + '<html><head><meta charset="utf-8"><title>Potvrda '+id+'</title>'
    + '<style>'
    + 'body{font-family:Arial,Helvetica,sans-serif; margin:40px; color:#111}'
    + 'h1{margin:0 0 10px 0; font-size:22px}'
    + '.muted{color:#555}'
    + '.grid{display:grid; grid-template-columns:180px 1fr; gap:6px 18px}'
    + '.box{border:1px solid #ddd; padding:14px; border-radius:8px; margin-top:14px}'
    + 'img.logo{height:36px}'
    + '.row{display:flex; justify-content:space-between; align-items:center}'
    + '.qr{width:120px; height:120px; border:1px solid #eee; padding:6px}'
    + '.foot{font-size:12px; color:#666; margin-top:14px}'
    + '.tt{font-weight:bold}'
    + '</style></head><body>'
    + '<div class="row"><div><img class="logo" src="'+base+'logo.png" alt="Centrotours"/></div>'
    + '<div><strong>Centrotours B2B Workshop 2025</strong><div class="muted">Swissotel Sarajevo ¬∑ 14. nov 2025</div></div></div>'
    + '<h1>Potvrda prijave ‚Ä¢ ID: '+id+'</h1>'
    + '<div class="box"><div class="grid">'
    + '<div class="tt">Naziv agencije</div><div>'+ (data.nazivAgencije||'') +'</div>'
    + '<div class="tt">Grad / sjedi≈°te</div><div>'+ (data.grad||'') +'</div>'
    + '<div class="tt">Web</div><div>'+ (data.web||'') +'</div>'
    + '<div class="tt">Broj zaposlenih</div><div>'+ (data.brojZaposlenih||'') +'</div>'
    + '<div class="tt">Godina osnivanja</div><div>'+ (data.godinaOsnivanja||'') +'</div>'
    + '<div class="tt">Kontakt</div><div>'+ (data.imePrezime||'') +' ‚Äî '+ (data.pozicija||'') +'</div>'
    + '<div class="tt">E-mail</div><div>'+ (data.email||'') +'</div>'
    + '<div class="tt">Telefon</div><div>'+ (data.telefon||'') +'</div>'
    + '<div class="tt">Tr≈æi≈°ta</div><div>'+ (data.trzista||'') +'</div>'
    + '<div class="tt">Aran≈æmana godi≈°nje</div><div>'+ (data.brojAranzmana||'') +'</div>'
    + '<div class="tt">Destinacije</div><div>'+ (data.destinacije||'') +'</div>'
    + '<div class="tt">Interes hotela</div><div>'+ (data.sastanak||'') +'</div>'
    + '<div class="tt">Broj osoba (B2B)</div><div>'+ (data.brojOsoba||'') +'</div>'
    + '<div class="tt">Engleski</div><div>'+ (data.engleski||'') +'</div>'
    + '<div class="tt">Napomene</div><div>'+ String(data.napomene||'').replace(/</g,'&lt;') +'</div>'
    + '<div class="tt">Networking Dinner</div><div>'+ (data.vecera||'') +'</div>'
    + '<div class="tt">Smje≈°taj</div><div>'+ (data.smjestaj||'') +'</div>'
    + '<div class="tt">Parking/dolazak</div><div>'+ String(data.parking||'').replace(/</g,'&lt;') +'</div>'
    + '<div class="tt">Saglasnost</div><div>'+ (data.saglasnost?'DA':'NE') +'</div>'
    + '<div class="tt">Potpis</div><div>'+ (data.potpis||'') +'</div>'
    + '</div></div>'
    + '<div class="row" style="margin-top:14px"><div class="foot">Verifikacija: skenirajte QR ili posjetite <br>'+data.verifyURL+'</div>'
    + '<img class="qr" src="'+qrDataURL+'" alt="QR" /></div>'
    + '<div class="foot">Generisano: '+ new Date().toLocaleString() +'</div>'
    + '<scr'+'ipt>window.onload=function(){window.print(); setTimeout(function(){window.close()},400);};</scr'+'ipt>'
    + '</body></html>';
    const w = window.open('', '_blank');
    w.document.open(); w.document.write(html); w.document.close();
  }
  </script>

  <script>
    // ====== KONFIGURACIJA ======
    const scriptURL = 'https://script.google.com/macros/s/AKfycbxf_XqH8M_q5k0nWM4_bfBTnR_0lOJdIozmlcGlErGEffhNElOtYbjjny8W7tdRaqI/exec'; // <<< POSTAVI OVDJE VA≈† Web App URL sa /exec
    const bgByStep = {1:'destinacija-1.jpg',2:'destinacija-2.jpg',3:'destinacija-3.jpg',4:'hurgada.jpg',5:'destinacija-6.jpg',6:'destinacija-2.jpg',7:'destinacija-3.jpg'};

    // ====== UI ELEMENTI ======
    const form = document.getElementById('form');
    const steps = Array.from(document.querySelectorAll('.step'));
    const hero = document.getElementById('hero');
    const bar = document.getElementById('bar');
    const nextBtn = document.getElementById('next');
    const prevBtn = document.getElementById('prev');
    const toast = document.getElementById('toast');
    const success = document.getElementById('success');
    const entryHidden = document.getElementById('entry_id');

    let current = 0;

    // Modal dobrodo≈°lice: 7s ‚Äî auto-close + tek nakon 7s dozvoli klik
    (function welcomeModalInit(){
      const modal = document.getElementById('welcomeModal');
      const btn   = document.getElementById('closeWelcome');
      const ctn   = document.getElementById('countdown');
      let s = 7;
      const tick = setInterval(()=>{
        s--; ctn.textContent = s;
        if(s<=0){
          clearInterval(tick);
          btn.disabled = false;
          btn.textContent = 'Zatvori';
          setTimeout(()=>{ modal.style.display='none'; }, 400);
          modal.addEventListener('click', e=>{
            if(e.target === modal) modal.style.display='none';
          }, { once:true });
        }
      }, 1000);
      btn.addEventListener('click', ()=>{ if(!btn.disabled) modal.style.display='none'; });
    })();

    function setHero(stepIndex){
      const n = stepIndex + 1;
      hero.style.backgroundImage = `linear-gradient(rgba(255,255,255,.0),rgba(255,255,255,.0)), url('${bgByStep[n] || bgByStep[1]}')`;
    }
    function show(i){
      steps.forEach((el,idx)=>el.classList.toggle('active', idx===i));
      bar.style.width = (((i+1)/steps.length)*100) + '%';
      prevBtn.disabled = (i===0);
      nextBtn.textContent = (i===steps.length-1) ? 'Po≈°alji' : 'Dalje ‚ü∂';
      setHero(i); window.scrollTo({top:0, behavior:'smooth'});
    }
    function showToast(msg){ toast.textContent = msg; toast.classList.add('show'); setTimeout(()=>toast.classList.remove('show'), 3200); }

    function validateStep(){
      const active = steps[current];
      // pojedinaƒçna polja (HTML5)
      const inputs = active.querySelectorAll('input,select,textarea');
      for(const el of inputs){
        if((el.type==='checkbox'||el.type==='radio')) continue;
        if(!el.checkValidity()){ el.reportValidity(); return false; }
      }
      // grupne provjere
      if(active.querySelector('legend')?.textContent?.includes('Glavna tr≈æi≈°ta')){
        if(active.querySelectorAll('input[name="trzista"]:checked').length===0){ showToast('Odaberite barem jedno tr≈æi≈°te.'); return false; }
      }
      if(active.querySelector('legend')?.textContent?.includes('Najƒçe≈°ƒáe destinacije')){
        if(active.querySelectorAll('input[name="destinacije"]:checked').length===0){ showToast('Odaberite barem jednu destinaciju.'); return false; }
      }
      if(active.querySelector('legend')?.textContent?.includes('Interes za sastanke')){
        if(active.querySelectorAll('input[name="sastanak"]:checked').length===0){ showToast('Odaberite barem jedan tip hotela.'); return false; }
      }
      return true;
    }

    // Navigacija
    prevBtn.addEventListener('click', ()=>{ if(current>0){ current--; show(current); }});
    nextBtn.type='button';
    nextBtn.addEventListener('click', async ()=>{
      if(current < steps.length-1){
        if(!validateStep()) return;
        current++; show(current); return;
      }
      await handleSubmit(); // zadnji korak
    });

    // Generi≈°i jedinstveni ID
    function makeID(){
      const d = new Date();
      const pad = (n)=>String(n).padStart(2,'0');
      const id = `CTS-${d.getFullYear()}${pad(d.getMonth()+1)}${pad(d.getDate())}-${pad(d.getHours())}${pad(d.getMinutes())}${pad(d.getSeconds())}-${Math.random().toString(36).slice(2,6).toUpperCase()}`;
      return id;
    }

    function gatherData(){
      // FormData -> plain object
      const fd = new FormData(form); const o = {};
      for(const [k,v] of fd.entries()){
        if(o[k]){ o[k] = Array.isArray(o[k]) ? o[k].concat(v) : [o[k], v]; }
        else o[k]=v;
      }
      // join checkbox arrays kao string (za PDF)
      ['trzista','destinacije','sastanak'].forEach(k=>{
        if(Array.isArray(o[k])) o[k] = o[k].join(', ');
      });
      return o;
    }

    async function handleSubmit(){
      // honeypot
      if((document.getElementById('hp').value||'').trim()){ showToast('Gre≈°ka.'); return; }

      // enforce telefon pattern
      const tel = form.telefon.value.trim();
      if(!/^[0-9]{9,15}$/.test(tel)){ showToast('Telefon: samo cifre, 9‚Äì15.'); form.telefon.focus(); return; }

      nextBtn.disabled=true; nextBtn.textContent='Slanje‚Ä¶';
      try{
        // ID + hidden
        const id = makeID(); entryHidden.value = id;

        // verifikacijski URL (vidi napomenu ispod o Apps Scriptu)
        const verifyURL = `${scriptURL.replace(/\\\/exec.*/, '/exec')}?verify=${encodeURIComponent(id)}`;

        // Skupi podatke
        const data = gatherData(); data.entry_id = id; data.verifyURL = verifyURL;

        // === SLANJE U SHEET ===
        const fd = new FormData(form);
        const res = await fetch(scriptURL, { method:'POST', body: fd });
        try{
          const j = await res.json();
          if(j && j.ok===false) throw new Error(j.error||'Gre≈°ka servera');
        }catch(_){}

        // === QR KOD ===
        const qr = window._miniQR(verifyURL, 6); // dataURL PNG

        // === PDF DOWNLOAD ===
        await generatePDF(data, qr);

        // UI final
        form.style.display='none'; success.classList.add('show');
      }catch(err){
        console.error(err); showToast('Nije poslano: ' + (err.message||err));
      }finally{
        nextBtn.disabled=false; nextBtn.textContent='Po≈°alji';
      }
    }

    // Inicijalizacija
    function initHero(){ setHero(0); show(0); }
    initHero();
  </script>

  <!--
    üîß NAPOMENA ZA VERIFIKACIJU QR KODA
    -----------------------------------
    Da bi skeniranje QR koda zaista "potvrdilo" prijavu, u Apps Script dodajte:
      1) U 'initSheet()' kolonu "Entry ID" (npr. zadnja kolona).
      2) U 'doPost(e)' spremite i getParam(e,'entry_id') u taj stupac.
      3) U 'doGet(e)' obradite ?verify=ID:
         - pretra≈æite Sheet po koloni "Entry ID"
         - odgovorite HTML-om "‚úÖ Prijava VALIDNA" ili "‚ùå Prijava NIJE pronaƒëena".
  -->
</body>
</html>
